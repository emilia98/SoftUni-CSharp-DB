USE "Ads";

SELECT DISTINCT 
	a1.Date AS "FirstDate", 
	a2.Date AS "SecondDate"
FROM 
	"Ads" AS a1, 
	"Ads" AS a2
WHERE 
	a1.Date < a2.Date 
	AND 
	DATEDIFF(hour, a1.Date, a2.Date) < 12
ORDER BY 
	a1.Date ASC, 
	a2.Date ASC;

/*
FirstDate	SecondDate
2014-12-23 19:04:27.000	2014-12-24 05:15:37.000
2014-12-24 17:38:58.000	2014-12-24 20:21:11.000
2014-12-24 17:38:58.000	2014-12-24 23:53:17.000
2014-12-24 20:21:11.000	2014-12-24 23:53:17.000
2014-12-26 05:14:30.000	2014-12-26 11:42:40.000
2014-12-26 05:14:30.000	2014-12-26 12:37:50.000
2014-12-26 11:42:40.000	2014-12-26 12:37:50.000
2014-12-26 11:42:40.000	2014-12-26 17:16:24.000
2014-12-26 12:37:50.000	2014-12-26 17:16:24.000
2014-12-26 17:16:24.000	2014-12-27 01:56:47.000
2014-12-30 23:43:30.000	2014-12-31 05:18:41.000
2015-01-01 09:08:38.000	2015-01-01 20:07:33.000
*/